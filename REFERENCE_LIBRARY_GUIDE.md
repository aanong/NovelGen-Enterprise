# èµ„æ–™åº“ç®¡ç†æŒ‡å—

æœ¬æŒ‡å—ä»‹ç»å¦‚ä½•ä¸ºå°è¯´æ·»åŠ å’Œç®¡ç†èµ„æ–™åº“ã€‚

## ğŸ“š æ¦‚è¿°

èµ„æ–™åº“ï¼ˆReference Libraryï¼‰ç”¨äºå­˜å‚¨å‚è€ƒèµ„æ–™ï¼Œå¸®åŠ©ç³»ç»Ÿåœ¨ç”Ÿæˆå°è¯´æ—¶è¿›è¡Œ RAG æ£€ç´¢ã€‚èµ„æ–™åº“å¯ä»¥ï¼š
- **å…¨å±€èµ„æ–™åº“**ï¼šæ‰€æœ‰å°è¯´å…±äº«çš„é€šç”¨èµ„æ–™ï¼ˆå¦‚ç»å…¸è®¾å®šã€é€šç”¨å‰§æƒ…å¥—è·¯ï¼‰
- **å°è¯´ä¸“å±èµ„æ–™åº“**ï¼šä¸ºç‰¹å®šå°è¯´æ·»åŠ çš„ä¸“å±èµ„æ–™ï¼ˆå¦‚è¯¥å°è¯´çš„ç‰¹æ®Šè®¾å®šã€äººç‰©åŸå‹ï¼‰

ç³»ç»Ÿæ£€ç´¢ä¼˜å…ˆçº§ï¼š**å°è¯´ä¸“å± > å…¨å±€é€šç”¨**ã€‚

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. æ•°æ®åº“è¿ç§»

ç¡®ä¿æ•°æ®åº“ schema å·²æ›´æ–°ï¼š

```bash
python -m src.scripts.manage_references migrate
```

### 2. ä½¿ç”¨ CLI ç®¡ç†èµ„æ–™åº“

æ¨èä½¿ç”¨ç»Ÿä¸€çš„ `manage_references` è„šæœ¬ã€‚

#### å‡†å¤‡æ•°æ®æ–‡ä»¶ (JSON)

åˆ›å»º JSON æ–‡ä»¶ `my_references.json`ï¼š

```json
[
  {
    "title": "ä¿®çœŸä¸–ç•ŒåŸºç¡€è®¾å®š",
    "content": "è¿™æ˜¯ä¸€ä¸ªä»¥ä¿®ç‚¼ä¸ºä¸»çš„ä¸–ç•Œï¼Œä¿®ç‚¼è€…é€šè¿‡å¸æ”¶å¤©åœ°çµæ°”æå‡å¢ƒç•Œ...",
    "source": "è‡ªå®šä¹‰",
    "category": "world_setting",
    "tags": ["ä¿®çœŸ", "å¢ƒç•Œ", "çµæ°”"]
  },
  {
    "title": "åºŸæé€†è¢­å¥—è·¯",
    "content": "ä¸»è§’åŸæœ¬æ˜¯åºŸæï¼Œé€šè¿‡å¥‡é‡æˆ–åŠªåŠ›ï¼Œæœ€ç»ˆé€†è¢­æˆä¸ºå¼ºè€…...",
    "source": "ç»å…¸å¥—è·¯",
    "category": "plot_trope",
    "tags": ["é€†è¢­", "æˆé•¿"]
  }
]
```

#### å¯¼å…¥å‘½ä»¤

```bash
# 1. å¯¼å…¥ä¸ºå…¨å±€èµ„æ–™åº“ (æ‰€æœ‰å°è¯´å¯è§)
python -m src.scripts.manage_references import my_references.json

# 2. å¯¼å…¥ä¸ºç‰¹å®šå°è¯´ (ID=1) çš„ä¸“å±èµ„æ–™åº“
python -m src.scripts.manage_references import my_references.json --novel-id 1

# 3. å¼ºåˆ¶è¦†ç›–å·²å­˜åœ¨çš„åŒåèµ„æ–™
python -m src.scripts.manage_references import my_references.json --force
```

### 3. ä½¿ç”¨ API ç®¡ç†

ä¹Ÿå¯ä»¥é€šè¿‡ RESTful API è¿›è¡Œç®¡ç†ã€‚

```bash
# æ·»åŠ å•ä¸ªèµ„æ–™åº“æ¡ç›®
curl -X POST "http://localhost:8000/api/novels/1/references" \
  -H "Content-Type: application/json" \
  -d '{
    "title": "ä¿®çœŸä¸–ç•ŒåŸºç¡€è®¾å®š",
    "content": "è¿™æ˜¯ä¸€ä¸ªä»¥ä¿®ç‚¼ä¸ºä¸»çš„ä¸–ç•Œ...",
    "category": "world_setting",
    "tags": ["ä¿®çœŸ", "å¢ƒç•Œ"]
  }'

# æ‰¹é‡æ·»åŠ 
curl -X POST "http://localhost:8000/api/novels/1/references/batch" \
  -H "Content-Type: application/json" \
  -d '[...]'
```
